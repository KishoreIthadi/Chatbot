<!DOCTYPE html>
<html>

<head>
    <title> iChatBot </title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.1/css/all.min.css">

    <link rel="stylesheet" href="./iChatBotStyle.css">

    <script src="./iChatBot.js"></script>
    <script src="./iChatBotConfig.js"></script>
    <script src="./dataset-basic-workflow.js"></script>
    <script src="./dataset-complex-workflow.js"></script>
    <script src="./dataset-fileupload-workflow.js"></script>
</head>

<body>

    <div style="margin: 30px;">
        <button id="btn_bwf" onclick="LoadChatBot('Basic')">Basic-WorkFlow</button>
        <button id="btn_cwf" onclick="LoadChatBot('Complex')">Complex-WorkFlow</button>
        <button id="btn_fuwf" onclick="LoadChatBot('FileUpload')">File-Upload-WorkFlow</button>
        <br><br>
        <button id="btn_showloader" onclick="showLoader(10000)">Show Loader(10000 ms)</button>
        <button id="btn_hideloader" onclick="hideLoader()">Hide Loader</button>
        <br><br>
        <button id="btn_showbot" onclick="openChatBot(10000)">Show ChatBot</button>
        <button id="btn_hidebot" onclick="closeChatBot()">Hide ChatBot</button>
        <br><br>
        <button id="btn_showerrormsg" onclick="showErrorMsg()">Show Error Message</button>
        <button id="btn_hideerrormsg" onclick="HideErrorMsg()">Hide Error Message</button>
        <br><br>
        <button id="btn_showchatsession" onclick="ShowChatSession()">Console.log(ChatSession)</button>
        <br><br>
        <h2>Work Flow Datasets</h2>
        <ul>
            <li> <a href="dataset-basic-workflow.js" target="_blank">Basic</a></li>
            <li><a href="dataset-complex-workflow.js" target="_blank">Complex</a></li>
            <li><a href="dataset-fileupload-workflow.js" target="_blank">FileUpload</a></li>
        </ul>
        <br><br>
    </div>

    <div id="ichatbot-div">
    </div>

    <script>
        // setting basic work flow on page load
        LoadChatBot("Basic");
        document.getElementsByTagName("button")[0].classList.add('border-blue-color');

        function LoadChatBot(value) {

            if (value == "Basic") {
                // Reading dataset from Basic-WorkFlow.js
                dataset = iChatBotDataset_BWF
            }
            else if (value == "Complex") {
                // Reading dataset from Complex-WorkFlow.js
                dataset = iChatBotDataset_CWF
            }
            else {
                // Reading dataset from File-Upload-WorkFlow.js
                dataset = iChatBotDataset_FUWL;
            }

            // iChatBotConfig is loaded from iChatBotConfig.js, script is added in header section
            iChatBot.initialize(iChatBotConfig, dataset), null;

            //Subscribing to UserInput Entered, User Button Click, Chat Reset, Chat Close events
            var userTextEvent = function UserText(chatSession, event) {
                console.log('ichatbot : user text input event fired')
                console.log(chatSession);
                console.log(event.searchFailed);

                // In case you want to execute own logic when keyword is not found
                // event.stop() will stop the functionality of showing "Keyword not found" message and call the configured query
                if (event.searchFailed) {
                    // event.stop();
                }
            }

            var buttonClickEvent = function ButtonClick(chatSession) {
                console.log('ichatbot : user button click event fired')
                console.log(chatSession);
            }

            var resetEvent = function Reset(chatSession) {
                console.log('ichatbot : chat reset event fired')
                console.log(chatSession);
            }

            var closeEvent = function Close(chatSession) {
                console.log('ichatbot : chat close event fired')
                console.log(chatSession);
            }

            var fileUploadEvent = function FileUpload(files, chatSession) {
                console.log('ichatbot : file upload event fired')
                console.log(files);
                console.log(chatSession);

                iChatBot.simpleQuery("<b>File Uploaded Sucessfully</b>")
                iChatBot.loadQuery(5);

                console.log(iChatBot.getChatSession());
            }

            iChatBot.subscribeEvent(userTextEvent, buttonClickEvent, resetEvent, closeEvent, fileUploadEvent);
        }

        function showLoader() {
            iChatBot.openChatBot();
            iChatBot.showLoader(5000);
        }

        function hideLoader() {
            iChatBot.openChatBot();
            iChatBot.hideLoader();
        }

        function openChatBot() {
            iChatBot.openChatBot();
        }

        function closeChatBot() {
            iChatBot.closeChatBot();
            iChatBot.hideLoader();
        }

        function showErrorMsg() {
            iChatBot.openChatBot();
            iChatBot.showErrorMsg("Error Message");
        }

        function HideErrorMsg() {
            iChatBot.openChatBot();
            iChatBot.showErrorMsg("");
        }

        function ShowChatSession() {
            console.log(iChatBot.getChatSession());
        }

        // Logic for adding border to selected button
        var buttons = document.getElementsByTagName("button");
        for (var i = 0; i < buttons.length; i++) {

            buttons[i].addEventListener("click", function (e) {
                var temp = document.getElementsByTagName("button");
                for (var j = 0; j < temp.length; j++) {
                    temp[j].classList.remove('border-blue-color');
                }
                e.target.classList.add('border-blue-color');
            });
        }

    </script>
</body>

</html>